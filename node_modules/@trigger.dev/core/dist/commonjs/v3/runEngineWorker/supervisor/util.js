"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getDefaultWorkerHeaders = getDefaultWorkerHeaders;
exports.redactKeys = redactKeys;
const consts_js_1 = require("../consts.js");
const util_js_1 = require("../util.js");
function getDefaultWorkerHeaders(options) {
    return (0, util_js_1.createHeaders)({
        Authorization: `Bearer ${options.workerToken}`,
        [consts_js_1.WORKER_HEADERS.INSTANCE_NAME]: options.instanceName,
        [consts_js_1.WORKER_HEADERS.DEPLOYMENT_ID]: options.deploymentId,
        [consts_js_1.WORKER_HEADERS.MANAGED_SECRET]: options.managedWorkerSecret,
    });
}
function redactString(value, end = 10) {
    return value.slice(0, end) + "*".repeat(value.length - end);
}
function redactNumber(value, end = 10) {
    const str = String(value);
    const redacted = redactString(str, end);
    return Number(redacted);
}
function redactKeys(obj, keys) {
    const redacted = { ...obj };
    for (const key of keys) {
        const value = obj[key];
        if (typeof value === "number") {
            redacted[key] = redactNumber(value);
        }
        else if (typeof value === "string") {
            redacted[key] = redactString(value);
        }
        else {
            continue;
        }
    }
    return redacted;
}
//# sourceMappingURL=util.js.map